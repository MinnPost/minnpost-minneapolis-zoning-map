/*! minnpost-minneapolis-zoning-map - LATEST VERSION - 2014-12-22
* https://github.com/minnpost/minnpost-minneapolis-zoning-map
* Copyright (c) 2014 MinnPost; Licensed MIT */

define("text!../bower.json",[],function(){return'{\n  "name": "minnpost-minneapolis-zoning-map",\n  "version": "0.0.0",\n  "main": "index.html",\n  "homepage": "https://github.com/minnpost/minnpost-minneapolis-zoning-map",\n  "repository": {\n    "type": "git",\n    "url": "https://github.com/minnpost/minnpost-minneapolis-zoning-map"\n  },\n  "bugs": "https://github.com/minnpost/minnpost-minneapolis-zoning-map/issues",\n  "license": "MIT",\n  "author": {\n    "name": "MinnPost",\n    "email": "data@minnpost.com"\n  },\n  "dependencies": {\n    "mapbox.js": "~1.6.4",\n    "ractive": "~0.5.6",\n    "ractive-events-tap": "~0.1.1",\n    "ractive-backbone": "~0.1.1",\n    "requirejs": "~2.1.15",\n    "almond": "~0.3.0",\n    "text": "~2.0.12",\n    "underscore": "~1.7.0",\n    "jquery": "~1.11.1",\n    "backbone": "~1.1.2",\n    "rgrove-lazyload": "*",\n    "minnpost-styles": "master"\n  },\n  "devDependencies": {\n    "qunit": "~1.15.0"\n  },\n  "dependencyMap": {\n    "requirejs": {\n      "rname": "requirejs",\n      "js": [\n        "requirejs/require"\n      ]\n    },\n    "almond": {\n      "rname": "almond",\n      "js": [\n        "almond/almond"\n      ]\n    },\n    "text": {\n      "rname": "text",\n      "js": [\n        "text/text"\n      ]\n    },\n    "jquery": {\n      "rname": "jquery",\n      "js": [\n        "jquery/dist/jquery"\n      ],\n      "returns": "$"\n    },\n    "underscore": {\n      "rname": "underscore",\n      "js": [\n        "underscore/underscore"\n      ],\n      "returns": "_"\n    },\n    "backbone": {\n      "rname": "backbone",\n      "js": [\n        "backbone/backbone"\n      ],\n      "returns": "Backbone"\n    },\n    "rgrove-lazyload": {\n      "rname": "lazyload",\n      "js": [\n        "rgrove-lazyload/lazyload"\n      ],\n      "returns": "Lazyload"\n    },\n    "ractive": {\n      "rname": "ractive",\n      "js": [\n        "ractive/ractive-legacy"\n      ],\n      "returns": "Ractive"\n    },\n    "ractive-backbone": {\n      "rname": "ractive-backbone",\n      "js": [\n        "ractive-backbone/ractive-adaptors-backbone"\n      ],\n      "returns": "RactiveBackbone"\n    },\n    "ractive-events-tap": {\n      "rname": "ractive-events-tap",\n      "js": [\n        "ractive-events-tap/ractive-events-tap"\n      ],\n      "returns": "RactiveEventsTap"\n    },\n    "mapbox.js": {\n      "rname": "mapbox",\n      "js": [\n        "mapbox.js/mapbox.uncompressed"\n      ],\n      "css": [\n        "mapbox.js/mapbox.uncompressed"\n      ],\n      "images": [\n        "mapbox.js/images"\n      ],\n      "returns": "L"\n    },\n    "minnpost-styles": {\n      "rname": "mpStyles",\n      "css": [\n        "//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css",\n        "minnpost-styles/dist/minnpost-styles"\n      ],\n      "sass": [\n        "minnpost-styles/styles/main"\n      ]\n    },\n    "mpConfig": {\n      "rname": "mpConfig",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.config"\n      ],\n      "returns": "mpConfig"\n    },\n    "mpFormatters": {\n      "rname": "mpFormatters",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.formatters"\n      ],\n      "returns": "mpFormatters"\n    },\n    "mpMaps": {\n      "rname": "mpMaps",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.maps"\n      ],\n      "returns": "mpMaps"\n    }\n  },\n  "resolutions": {\n    "underscore": ">=1.5.0"\n  }\n}\n'}),define("base",["jquery","underscore","backbone","lazyload","mpFormatters","text!../bower.json"],function(a,b,c,d,e,f){var g={};return f=JSON.parse(f),g.BaseApp=function(c){this.options=b.extend(this.baseDefaults||{},this.defaults||{},c||{}),this.name=this.options.name,this.options.el&&(this.el=this.options.el,this.$el=a(this.el),this.$=function(a){return this.$el.find(a)}),this.determinePaths(),this.renderAssests(),this.on("cssLoaded",function(){this.initialize.apply(this,arguments)})},b.extend(g.BaseApp.prototype,c.Events,{bower:f,baseDefaults:{jsonpProxy:"//mp-jsonproxy.herokuapp.com/proxy?url=",availablePaths:{local:{css:[".tmp/css/main.css"],images:"images/",data:"data/"},build:{css:["dist/[[[PROJECT_NAME]]].libs.min.css","dist/[[[PROJECT_NAME]]].latest.min.css"],images:"dist/images/",data:"dist/data/"},deploy:{css:["//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/[[[PROJECT_NAME]]].libs.min.css","//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/[[[PROJECT_NAME]]].latest.min.css"],images:"//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/images/",data:"//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/data/"}}},determinePaths:function(){var a;return b.isObject(this.options.paths)&&!b.isUndefined(this.options.deployment)?this.options.paths:(this.options.deployment="deploy",-1!==window.location.host.indexOf("localhost")&&(this.options.deployment="local",a=this.parseQueryString(),b.isObject(a)&&b.isString(a.mpDeployment)&&(this.options.deployment=a.mpDeployment)),this.options.paths=this.options.availablePaths[this.options.deployment],this.options.paths)},renderAssests:function(){var a=this,c=[];b.each(this.bower.dependencyMap,function(d){d.css&&b.each(d.css,function(b){"local"===a.options.deployment?(b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",c.push(a.makePath(b))):b.match(/^(http|\/\/)/)&&c.push(a.makePath(b))})}),b.each(this.options.paths.css,function(b){c.push(a.makePath(b))}),d.css(c,function(){this.trigger("cssLoaded")},null,this)},makePath:function(a){return a=a.split("[[[PROJECT_NAME]]]").join(this.name),this.options.basePath&&!a.match(/^(http|\/\/)/)&&(a=this.options.basePath+a),a},overrideBackboneAJAX:function(){c.ajax=function(){var a=arguments[0];return a.dataTypeForce!==!0?this.jsonpRequest(a):c.$.ajax.apply(c.$,[a])}},isMSIE:function(){var a=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return a?parseInt(a[2],10):!1},parseQueryString:function(){var a={},c=function(a){return decodeURIComponent(a.replace(/\+/g," "))},d=location.search.substring(1),e=d.split("&");return b.each(e,function(b){var d=b.split("=");d.length>1&&(a[c(d[0])]=c(d[1]))}),a},jsonpRequest:function(b){return b.dataType="jsonp",this.options.jsonpProxy&&-1===b.url.indexOf("callback=")&&(b.jsonpCallback="mpServerSideCachingHelper"+e.hash(b.url),b.url=this.options.jsonpProxy+encodeURIComponent(b.url)+"&callback="+b.jsonpCallback,b.cache=!0),a.ajax.apply(a,[b])},dataRequest:function(c){var d=this,e=!1,f=[];return c=b.isArray(name)?c:[c],0===this.options.paths.data.indexOf("http")&&(e=!0),b.each(c,function(b){var c=e?d.jsonpRequest(d.options.paths.data+b):a.getJSON(d.options.paths.data+b);f.push(c)}),a.when.apply(a,f)},initialize:function(){}}),g.BaseApp.extend=c.Model.extend,g}),define("text!templates/application.mustache",[],function(){return'<div class="application-container">\n  <div class="message-container"></div>\n\n  <div class="content-container">\n\n    <div class="component-label">Minneapolis primary zoning districts</div>\n    <div class="caption">Minneapolis primary zoning districts colored by type of district.  Data up to date as of December 11, 2014.  Minneapolis overlay zoning districts not included.  Click or tap on the legend to see the specific Minneapolis code for each zoning district.</div>\n\n    <div class="map" id="mpls-zoning-map"></div>\n\n    <div class="legend-container row small">\n      {{#each zoneTypes:zi}}\n        <div class="column-medium-20">\n          <div class="component-label">{{ zi.replace(\'Districts\', \'\') }}</div>\n          <a class="general-provisions" href="{{ muniCodeTemplate.replace(\'[[[NODE]]]\', this[0].gen_node )}}" target="_blank">General provisions</a>\n          <ul>\n            {{#each . }}\n              <li>\n                <a\n                  class="legend-swatch"\n                  style="background-color: {{ zoneColors[id] }};"\n                  href="{{ muniCodeTemplate.replace(\'[[[NODE]]]\', node )}}"\n                  target="_blank"\n                  title="Specific provisions for distrct">\n                  {{ id }}\n                </a>\n                {{ type.replace(\'District\', \'\') }}\n              </li>\n            {{/each}}\n          </ul>\n        </div>\n      {{/each}}\n    </div>\n\n  </div>\n\n  <div class="footnote-container">\n    <div class="footnote">\n      <p>Some map data © OpenStreetMap contributors; licensed under the <a href="http://www.openstreetmap.org/copyright" target="_blank">Open Data Commons Open Database License</a>.  Some map design © MapBox; licensed according to the <a href="http://mapbox.com/tos/" target="_blank">MapBox Terms of Service</a>.</p>\n\n      <p>Some code, techniques, and data on <a href="https://github.com/minnpost/minnpost-minneapolis-zoning-map" target="_blank">Github</a>.</p>\n\n    </div>\n  </div>\n</div>\n'}),define("text!templates/tooltip-map-zoning.underscore",[],function(){return"<div>\n  <div class=\"component-label\"><%= data.ZONE_CODE %> district</div>\n  <div><%= zMap[data.ZONE_CODE.replace(/-[0-9]+/, '')].type %></div>\n</div>\n"}),require(["jquery","underscore","backbone","lazyload","ractive","ractive-backbone","ractive-events-tap","mapbox","mpConfig","mpFormatters","mpMaps","base","text!templates/application.mustache","text!templates/tooltip-map-zoning.underscore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=l.BaseApp.extend({defaults:{name:"minnpost-minneapolis-zoning-map",el:".minnpost-minneapolis-zoning-map-container",mapboxZoning:"minnpost.map-vhjzpwel,minnpost.q2iq9f6r,minnpost.map-dotjndlk",mapboxBase:"//{s}.tiles.mapbox.com/v3/",mapboxToken:"pk.eyJ1IjoibWlubnBvc3QiLCJhIjoicUlOUkpvWSJ9.djE93rNktev9eWRJVav6xA",mpls_code_template:"https://www.municode.com/library/mn/minneapolis/codes/code_of_ordinances?nodeId=[[[NODE]]]",zoningTypeMap:{R1:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIIR1SIMIDI",type:"Single-family District (low density)"},R1A:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIIIR1SIMIDI",type:"Single-family District (low density)"},R2:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIVR2TMIDI",type:"Two-family District (low density)"},R2B:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTVR2TMIDI",type:"Two-family District (low density)"},R3:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTVIR3MUMIDI",type:"Multiple-family District (medium density)"},R4:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTVIIR4MUMIDI",type:"Multiple-family District (medium density)"},R5:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTVIIIR5MUMIDI",type:"Multiple-family District (high density)"},R6:{gen_type:"Residential",gen_node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH546REDI_ARTIXR6MUMIDI",type:"Multiple-family District (high density)"},C1:{gen_type:"Commercial Districts",gen_node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIIC1NECODI",type:"Neighborhood Commercial District"},C2:{gen_type:"Commercial Districts",gen_node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIIIC2NECOCODI",type:"Neighborhood Corridor Commercial District"},C3A:{gen_type:"Commercial Districts",gen_node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIVC3COACCEDI",type:"Community Activity Center District"},C3S:{gen_type:"Commercial Districts",gen_node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH548CODI_ARTVC3COSHCEDI",type:"Community Shopping Center District"},C4:{gen_type:"Commercial Districts",gen_node:"MICOOR_TIT20ZOCO_CH548CODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH548CODI_ARTVIC4GECODI",type:"General Commercial District"},B4:{gen_type:"Downtown Districts",gen_node:"MICOOR_TIT20ZOCO_CH549DODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH549DODI_ARTVB4DOBUDI",type:"Downtown Business District"},B4S:{gen_type:"Downtown Districts",gen_node:"MICOOR_TIT20ZOCO_CH549DODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH549DODI_ARTVIB4DOSEDI",type:"Downtown Service District"},B4C:{gen_type:"Downtown Districts",gen_node:"MICOOR_TIT20ZOCO_CH549DODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH549DODI_ARTVIIB4DOCODI",type:"Downtown Commercial District"},B4N:{gen_type:"Downtown Districts",gen_node:"MICOOR_TIT20ZOCO_CH549DODI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH549DODI_ARTVIIIB4DONEDI",type:"Downtown Neighborhood District"},OR1:{gen_type:"Office Residence Districts",gen_node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIIORNEOFREDI",type:"Neighborhood Office Residence District"},OR2:{gen_type:"Office Residence Districts",gen_node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIIIORHIDEOFREDI",type:"High Density Office Residence District"},OR3:{gen_type:"Office Residence Districts",gen_node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH547OFREDI_ARTIVORINOFREDI",type:"Institutional Office Residence District"},I1:{gen_type:"Industrial Districts",gen_node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIII1LIINDI",type:"Light Industrial District"},I2:{gen_type:"Industrial Districts",gen_node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIIII2MEINDI",type:"Medium Industrial District"},I3:{gen_type:"Industrial Districts",gen_node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIGEPR",node:"MICOOR_TIT20ZOCO_CH550INDI_ARTIVI3GEINDI",type:"General Industrial District"}},zoneColorMap:{R1:"rgb(199,233,192)",R1A:"rgb(199,233,192)",R2:"rgb(161,217,155)",R2B:"rgb(161,217,155)",R3:"rgb(116,196,118)",R4:"rgb(65,171,93)",R5:"rgb(35,139,69)",R6:"rgb(0,90,50)",OR1:"rgb(189,215,231)",OR2:"rgb(107,174,214)",OR3:"rgb(33,113,181);",C1:"rgb(252,187,161)",C2:"rgb(252,146,114)",C3A:"rgb(251,106,74)",C3S:"rgb(222,45,38)",C4:"rgb(165,15,21)",I1:"rgb(204,204,204)",I2:"rgb(150,150,150)",I3:"rgb(82,82,82)",B4:"rgb(203,201,226)",B4S:"rgb(158,154,200)",B4C:"rgb(117,107,177)",B4N:"rgb(84,39,143)"}},initialize:function(){var c=this;b.each(this.options.zoningTypeMap,function(a,b){c.options.zoningTypeMap[b].id=b}),this.mainView=new e({el:this.$el,template:m,data:{zoneColors:this.options.zoneColorMap,zoneTypes:b.groupBy(this.options.zoningTypeMap,"gen_type"),muniCodeTemplate:this.options.mpls_code_template},partials:{}}),this.on("dataLoaded",function(){this.makeMaps()}),a.ajax({url:this.options.mapboxBase.replace("{s}","a")+this.options.mapboxZoning+".json?callback=?",dataType:"jsonp",cache:!0,success:function(a){c.tilejsonZoning=a,c.trigger("dataLoaded")}})},makeMaps:function(){var a=this;h.mapbox.accessToken=this.options.mapboxToken,this.mapZoning=h.mapbox.map("mpls-zoning-map",this.tilejsonZoning,{scrollWheelZoom:!1,trackResize:!0,minZoom:9,maxZoom:16}),this.mapZoning.setView(k.minneapolisPoint,13),this.mapZoning.removeControl(this.mapZoning.attributionControl),this.mapZoning.gridControl._template=function(c,d){if(d){var e=this.options.template||this._layer.getTileJSON().template;return e?this.options.sanitizer(b.template(e)({format:j,zMap:a.options.zoningTypeMap,data:d})):void 0}},this.mapZoning.gridControl.setTemplate(n),this.mapZoning.gridControl.options.pinnable=!1}});return new o({})}),define("app",function(){});